<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Powered Web App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { 
            font-family: 'Arial', sans-serif; 
            background-color: #f4f4f4;
        }
        .loader {
            border-top-color: #3498db;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // OpenAI Configuration (Replace with your actual API key)
        const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY';

        // AI Service Hook
        const useOpenAI = () => {
            const generateChat = async (messages) => {
                try {
                    const response = await axios.post('https://api.openai.com/v1/chat/completions', {
                        model: "gpt-3.5-turbo",
                        messages: messages,
                        max_tokens: 150
                    }, {
                        headers: {
                            'Authorization': `Bearer ${OPENAI_API_KEY}`,
                            'Content-Type': 'application/json'
                        }
                    });
                    return response.data.choices[0].message.content;
                } catch (error) {
                    console.error('Chat Error:', error);
                    return "Sorry, I couldn't generate a response.";
                }
            };

            const generateImage = async (prompt) => {
                try {
                    const response = await axios.post('https://api.openai.com/v1/images/generations', {
                        model: "dall-e-2",
                        prompt: prompt,
                        n: 1,
                        size: "256x256"
                    }, {
                        headers: {
                            'Authorization': `Bearer ${OPENAI_API_KEY}`,
                            'Content-Type': 'application/json'
                        }
                    });
                    return response.data.data[0].url;
                } catch (error) {
                    console.error('Image Error:', error);
                    return null;
                }
            };

            return { generateChat, generateImage };
        };

        // Main App Component
        const App = () => {
            const [activeTab, setActiveTab] = React.useState('chat');
            const [theme, setTheme] = React.useState('light');

            const toggleTheme = () => {
                setTheme(theme === 'light' ? 'dark' : 'light');
            };

            const renderContent = () => {
                switch(activeTab) {
                    case 'chat': return <ChatInterface />;
                    case 'image': return <ImageGenerator />;
                    default: return <ChatInterface />;
                }
            };

            return (
                <div className={`min-h-screen ${theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-black'}`}>
                    <nav className="bg-blue-500 p-4 flex justify-between items-center">
                        <h1 className="text-2xl font-bold text-white">AI Web App</h1>
                        <div>
                            <button 
                                onClick={toggleTheme} 
                                className="bg-white text-blue-500 px-4 py-2 rounded"
                            >
                                {theme === 'light' ? 'Dark Mode' : 'Light Mode'}
                            </button>
                        </div>
                    </nav>
                    
                    <div className="flex">
                        <div className="w-1/4 bg-gray-200 p-4">
                            <button 
                                onClick={() => setActiveTab('chat')}
                                className={`w-full mb-2 p-2 ${activeTab === 'chat' ? 'bg-blue-500 text-white' : 'bg-white text-blue-500'}`}
                            >
                                Chat AI
                            </button>
                            <button 
                                onClick={() => setActiveTab('image')}
                                className={`w-full p-2 ${activeTab === 'image' ? 'bg-blue-500 text-white' : 'bg-white text-blue-500'}`}
                            >
                                Image Generator
                            </button>
                        </div>
                        
                        <div className="w-3/4 p-4">
                            {renderContent()}
                        </div>
                    </div>
                </div>
            );
        };

        // Chat Interface Component
        const ChatInterface = () => {
            const [messages, setMessages] = React.useState([]);
            const [input, setInput] = React.useState('');
            const [isLoading, setIsLoading] = React.useState(false);
            const { generateChat } = useOpenAI();

            const handleSendMessage = async () => {
                if (!input.trim()) return;

                const newMessages = [...messages, { role: 'user', content: input }];
                setMessages(newMessages);
                setInput('');
                setIsLoading(true);

                try {
                    const aiResponse = await generateChat(newMessages);
                    setMessages(prev => [...prev, { 
                        role: 'assistant', 
                        content: aiResponse 
                    }]);
                } catch (error) {
                    console.error('Message send error:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <div className="border rounded p-4">
                    <div className="h-96 overflow-y-auto mb-4">
                        {messages.map((msg, index) => (
                            <div 
                                key={index} 
                                className={`mb-2 p-2 rounded ${
                                    msg.role === 'user' 
                                    ? 'bg-blue-100 text-right' 
                                    : 'bg-green-100 text-left'
                                }`}
                            >
                                {msg.content}
                            </div>
                        ))}
                        {isLoading && (
                            <div className="text-center">
                                <div className="loader inline-block w-8 h-8 border-4 border-solid rounded-full"></div>
                            </div>
                        )}
                    </div>
                    <div className="flex">
                        <input 
                            type="text" 
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            className="flex-grow p-2 border rounded mr-2"
                            placeholder="Type your message..."
                        />
                        <button 
                            onClick={handleSendMessage}
                            className="bg-blue-500 text-white px-4 py-2 rounded"
                        >
                            Send
                        </button>
                    </div>
                </div>
            );
        };

        // Image Generator Component
        const ImageGenerator = () => {
            const [prompt, setPrompt] = React.useState('');
            const [image, setImage] = React.useState(null);
            const [isLoading, setIsLoading] = React.useState(false);
            const { generateImage } = useOpenAI();

            const handleGenerateImage = async () => {
                if (!prompt.trim()) return;

                setIsLoading(true);
                setImage(null);

                try {
                    const imageUrl = await generateImage(prompt);
                    setImage(imageUrl);
                } catch (error) {
                    console.error('Image generation error:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <div className="border rounded p-4">
                    <div className="flex mb-4">
                        <input 
                            type="text" 
                            value={prompt}
                            onChange={(e) => setPrompt(e.target.value)}
                            className="flex-grow p-2 border rounded mr-2"
                            placeholder="Describe the image you want to generate"
                        />
                        <button 
                            onClick={handleGenerateImage}
                            className="bg-blue-500 text-white px-4 py-2 rounded"
                        >
                            Generate
                        </button>
                    </div>
                    {isLoading && (
                        <div className="text-center">
                            <div className="loader inline-block w-8 h-8 border-4 border-solid rounded-full"></div>
                        </div>
                    )}
                    {image && (
                        <div className="mt-4 text-center">
                            <img 
                                src={image} 
                                alt="Generated" 
                                className="max-w-full mx-auto rounded"
                            />
                        </div>
                    )}
                </div>
            );
        };

        // Render the App
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
